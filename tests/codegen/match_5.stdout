<?php

namespace Kernel\Types {
  abstract class Maybe {}

  class Just extends \Kernel\Types\Maybe {
    function __construct($a) {
      $this->{0} = $a;
    }
  }

  class None extends \Kernel\Types\Maybe {}
}

namespace Kernel\Builtins {
  // #[inline]
  // #[construct]
  function _print($a) {
    print($a);
  }

  // #[inline]
  // #[construct]
  function cast_int_to_string($a) {
    return (string)$a;
  }

  // #[inline]
  // #[construct]
  function cast_float_to_string($a) {
    return (string)$a;
  }
}

namespace Io {
  // #[inline]
  function println($str) {
    \Kernel\Builtins\_print($str . "\n");
  }
}

namespace Fmt {
  // #[inline]
  function float($f) {
    return \Kernel\Builtins\cast_float_to_string($f);
  }
}

namespace match_5 {
  abstract class Shape {}

  class UnitCircle extends \match_5\Shape {}

  class Circle extends \match_5\Shape {
    function __construct($a) {
      $this->{0} = $a;
    }
  }

  class Square extends \match_5\Shape {
    function __construct($a) {
      $this->{0} = $a;
    }
  }

  class Rect extends \match_5\Shape {
    public $width;
    public $height;
    function __construct($args) {
      $this->width = $args["width"];
      $this->height = $args["height"];
    }
  }

  function describe($sh) {
    if ($sh instanceof \match_5\UnitCircle) {
      $a = "unit circle";
    } else if ($sh instanceof \match_5\Circle) {
      $r = $sh->{0};
      $a = "circle with radius " . \Fmt\float($r);
    } else if ($sh instanceof \match_5\Square) {
      $s = $sh->{0};
      $a = "square with perimeter " . \Fmt\float(4.0 * $s);
    } else if ($sh instanceof \match_5\Rect) {
      $w = $sh->width;
      $h = $sh->height;
      $a = "rectangle with area " . \Fmt\float($w * $h);
    }
    \Io\println($a);
  }

  // #[entry]
  function main() {
    \match_5\describe(new \match_5\UnitCircle());
    \match_5\describe(new \match_5\Circle(2.0));
    \match_5\describe(new \match_5\Square(2.5));
    \match_5\describe(new \match_5\Rect([
      "width" => 5.5,
      "height" => 1.2
    ]));
  }
}

namespace {
  \match_5\main();
}
